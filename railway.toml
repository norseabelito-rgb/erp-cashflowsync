# Test deployment
[build]
builder = "NIXPACKS"
installCommand = "npm install --legacy-peer-deps"
buildCommand = "npx prisma generate && npm run build"

[deploy]
# Safe migration script that uses IF NOT EXISTS - won't delete data
# After migration, backfill postal codes for orders missing them (limit 200 per deploy)
# Backfill dezactivat temporar - /reports/streets FanCourier returnează 0 rezultate
# TODO: Investighează cu FanCourier sau folosește bază de date statică pentru coduri poștale
startCommand = "node scripts/force-migration.js && npm run start"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
