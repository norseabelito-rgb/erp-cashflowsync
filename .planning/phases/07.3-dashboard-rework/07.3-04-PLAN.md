---
phase: 07.3-dashboard-rework
plan: 04
type: execute
wave: 2
depends_on: ["07.3-01", "07.3-02"]
files_modified:
  - src/app/(dashboard)/dashboard/page.tsx
autonomous: true

must_haves:
  truths:
    - "Clicking Vanzari card navigates to /invoices with current date filters"
    - "Clicking De Procesat card navigates to /orders with status=PENDING,VALIDATED and current filters"
    - "Clicking Expediate card navigates to /tracking with current filters"
    - "Clicking channel cards navigates to /orders with source filter + current filters"
    - "All navigation hrefs include current date range and store from URL"
  artifacts:
    - path: "src/app/(dashboard)/dashboard/page.tsx"
      provides: "Dynamic href generation for stat cards"
      contains: "buildFilteredHref|params.toString"
  key_links:
    - from: "StatCard href"
      to: "target pages"
      via: "Link navigation with searchParams"
      pattern: "href=.*startDate|endDate|store"
---

<objective>
Make all stat cards clickable with navigation that preserves current filter context.

Purpose: Users want to click a card to see details. Currently href is hardcoded without filters, so clicking "De Procesat" goes to /orders but doesn't apply the same date/store filter user selected on dashboard.

Output: Clicking any stat card navigates to relevant page with current filters preserved in URL
</objective>

<execution_context>
@/Users/stefanpanaite/.claude/get-shit-done/workflows/execute-plan.md
@/Users/stefanpanaite/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07.3-dashboard-rework/07.3-RESEARCH.md

# Dashboard page (after Plan 01, 02, 03)
@src/app/(dashboard)/dashboard/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create href builder function</name>
  <files>src/app/(dashboard)/dashboard/page.tsx</files>
  <action>
Add a helper function in dashboard page.tsx to build hrefs with current filters:

1. Create function buildFilteredHref inside DashboardPage component (needs access to searchParams):
   ```typescript
   function buildFilteredHref(basePath: string, extraParams?: Record<string, string>): string {
     const params = new URLSearchParams();

     // Preserve date filters if set
     const startDate = searchParams.startDate;
     const endDate = searchParams.endDate;
     const store = searchParams.store;

     if (startDate) params.set("startDate", startDate);
     if (endDate) params.set("endDate", endDate);
     if (store) params.set("store", store);

     // Add any extra params (like status filter)
     if (extraParams) {
       Object.entries(extraParams).forEach(([key, value]) => {
         params.set(key, value);
       });
     }

     const queryString = params.toString();
     return queryString ? `${basePath}?${queryString}` : basePath;
   }
   ```

2. This function:
   - Takes base path (e.g., "/orders")
   - Optionally takes extra params (e.g., { status: "PENDING,VALIDATED" })
   - Returns full URL with all filters combined
  </action>
  <verify>
Run: grep -n "buildFilteredHref" src/app/(dashboard)/dashboard/page.tsx
Should show function definition.
  </verify>
  <done>buildFilteredHref helper function created for generating filtered navigation URLs</done>
</task>

<task type="auto">
  <name>Task 2: Update all stat card hrefs to use filtered URLs</name>
  <files>src/app/(dashboard)/dashboard/page.tsx</files>
  <action>
Update each StatCard's href prop to use buildFilteredHref:

1. "Vanzari" card:
   - Current: href="/invoices"
   - Updated: href={buildFilteredHref("/invoices")}
   - Preserves date range to show invoices from same period

2. "De procesat" card:
   - Current: href="/orders?status=PENDING,VALIDATED"
   - Updated: href={buildFilteredHref("/orders", { status: "PENDING,VALIDATED" })}
   - Combines status filter with date/store filters

3. "Expediate" card:
   - Current: href="/tracking"
   - Updated: href={buildFilteredHref("/tracking")}
   - Note: tracking page should support date filter for AWB createdAt

4. "Comenzi Shopify" card:
   - Current: href="/orders?source=shopify"
   - Updated: href={buildFilteredHref("/orders", { source: "shopify" })}
   - Shows Shopify orders with date/store filters

5. "Comenzi Trendyol" card:
   - Current: href="/orders?source=trendyol"
   - Updated: href={buildFilteredHref("/orders", { source: "trendyol" })}
   - Shows Trendyol orders with date/store filters

6. "Total Comenzi" card (if present):
   - Current: href="/orders"
   - Updated: href={buildFilteredHref("/orders")}
   - Shows all orders with date/store filters

7. "Trendyol de procesat" card:
   - Current: href="/orders?source=trendyol&status=PENDING,VALIDATED"
   - Updated: href={buildFilteredHref("/orders", { source: "trendyol", status: "PENDING,VALIDATED" })}
   - Combines source and status with date/store filters

8. Any other clickable cards - apply same pattern
  </action>
  <verify>
Run: grep -n "buildFilteredHref" src/app/(dashboard)/dashboard/page.tsx | wc -l
Should show multiple usages (at least 6).
  </verify>
  <done>All stat card hrefs use buildFilteredHref to preserve filter context in navigation</done>
</task>

</tasks>

<verification>
1. Start dev server: npm run dev
2. Visit /dashboard?startDate=2026-01-15&endDate=2026-01-20&store=abc123
3. Click "De procesat" card
   - Should navigate to /orders?startDate=2026-01-15&endDate=2026-01-20&store=abc123&status=PENDING,VALIDATED
4. Go back to dashboard (with same filters)
5. Click "Vanzari" card
   - Should navigate to /invoices?startDate=2026-01-15&endDate=2026-01-20&store=abc123
6. Go back to dashboard
7. Click "Expediate" card
   - Should navigate to /tracking?startDate=2026-01-15&endDate=2026-01-20&store=abc123
8. Verify all clickable cards maintain filter context
</verification>

<success_criteria>
- Clicking any stat card preserves current date range in navigation
- Clicking any stat card preserves current store filter in navigation
- Extra params (status, source) are combined with preserved filters
- Navigation URLs are clean (no duplicate params, no empty values)
</success_criteria>

<output>
After completion, create `.planning/phases/07.3-dashboard-rework/07.3-04-SUMMARY.md`
</output>
